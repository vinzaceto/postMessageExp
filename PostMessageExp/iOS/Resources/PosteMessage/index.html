<!DOCTYPE html>
<html lang="en">
<head>
    <title>Comunicazione Post Message iOS</title>
</head>
<body>

<form id="form">
    <input type="text" placeholder="Enter message" name="message">
    <input type="submit" value="Click to send">
</form>

<script>
    //Register to eventListener (For Test)
    window.addEventListener('message', function (event) {

    {
  "MESSAGE": {
    "MESSAGE_TYPE": "STRING",
    "REQUEST_ACTION": "STRING",
    "FLOW_DATA": {
      "ID_PROCESSO": "STRING",
     "NOME_PROCESSO": "STRING",
      "ESITO": "STRING",
      "CODICE_ESITO": "STRING",
      "TIPOLOGIA_ESITO": "STRING"

    },
    "TRACKING_ANALYTICS": {
      "LIVELLO2": "STRING",
      "LIVELLO3": "STRING"
    }
  }
}

    var messageToJson = {
        MESSAGE = {
            MESSAGE_TYPE: "STRING",
            REQUEST_ACTION: "STRING",
            FLOW_DATA: {
                ID_PROCESSO: "STRING",
                NOME_PROCESSO: "STRING",
                ESITO: "STRING",
                CODICE_ESITO: "STRING",
                TIPOLOGIA_ESITO: "STRING"

            },
            TRACKING_ANALYTICS: {
                LIVELLO2: "STRING",
                LIVELLO3: "STRING"
            }
        }
    }

    window.location = "postMesssageIsCalling://" + JSON.stringify(messageToJson);
    //Send json to App
    sendToApp(JSON.stringify(messageToJson));

    alert(`Received ${event.data} from ${event.origin}`);
});

    //Register form to onsubmit event (For Test)
  form.onsubmit = function () {
    window.postMessage(this.message.value, '*');
    return false;
};

function sendToApp(messageBody)
{
    // this must be used to call the WkWebView message handler
    window.webkit.messageHandlers.sendToApp.postMessage(messageBody);
}

function sendToWebviewContainer(json) {
    window.postMessage(json, '*');
}
</script>
</body>
</html>
